"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[407],{1113:function(e,t,a){a.d(t,{AdSlot:function(){return s}});var r=a(7437);function s(e){let{slot:t,className:a=""}=e;return(0,r.jsx)("div",{className:"flex items-center justify-center bg-muted rounded-lg border-2 border-dashed border-border ".concat({header:"min-h-[90px] md:min-h-[90px]",sidebar:"min-h-[250px] md:min-h-[600px]","in-content":"min-h-[280px]",footer:"min-h-[90px]"}[t]," ").concat(a),"data-testid":"ad-slot-".concat(t)})}},4408:function(e,t,a){a.d(t,{LevelPageClient:function(){return T}});var r=a(7437),s=a(2265),l=a(166),i=a(1671),o=a(1723),n=a(3276);function d(e){let{id:t,title:a,duration:s,snippet:l,level:d,onPlayClick:c,listenPercentage:u=0}=e;return(0,r.jsxs)("div",{className:"bg-card rounded-xl border p-4 hover-elevate active-elevate-2 transition-all relative","data-testid":"card-audio-".concat(t),children:[u>=90&&(0,r.jsxs)("div",{className:"absolute top-3 right-3 flex items-center gap-1.5 bg-green-500/10 text-green-600 dark:text-green-400 px-2.5 py-1 rounded-full text-xs font-medium border border-green-500/20","data-testid":"badge-completed-".concat(t),children:[(0,r.jsx)(i.Z,{className:"h-3.5 w-3.5"}),(0,r.jsx)("span",{children:"Escuchado"})]}),u>0&&u<90&&(0,r.jsxs)("div",{className:"absolute top-3 right-3 flex items-center gap-1.5 bg-yellow-500/10 text-yellow-600 dark:text-yellow-400 px-2.5 py-1 rounded-full text-xs font-medium border border-yellow-500/20","data-testid":"badge-in-progress-".concat(t),children:[(0,r.jsx)(o.Z,{className:"h-3.5 w-3.5"}),(0,r.jsx)("span",{children:"En progreso"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-lg mb-1 pr-24","data-testid":"text-audio-title-".concat(t),children:a}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-2","data-testid":"text-audio-duration-".concat(t),children:s}),l&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground italic line-clamp-2","data-testid":"text-audio-snippet-".concat(t),children:l})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>{window.gtag&&window.gtag("event","audio_play",{level:d.toUpperCase(),title:a}),null==c||c()},className:"p-3 rounded-full bg-primary text-primary-foreground hover-elevate active-elevate-2 border-2 border-primary-border","aria-label":"Reproducir audio","data-testid":"button-play-".concat(t),children:(0,r.jsx)(n.Z,{className:"h-4 w-4 ml-0.5"})}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Click to listen"})]})]})]})}var c=a(2489),u=a(9227),m=a(8736),p=a(5368);function x(e){let{isOpen:t,onClose:a,audio:s,isPlaying:l,onPlayPause:i,onShowTranscript:o,onShowQuiz:d}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",onClick:a,"data-testid":"modal-audio-overlay",children:(0,r.jsxs)("div",{className:"bg-background border rounded-xl shadow-lg max-w-2xl w-full p-6 space-y-6",onClick:e=>e.stopPropagation(),"data-testid":"modal-audio-content",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold pr-8","data-testid":"text-modal-title",children:s.title}),(0,r.jsx)("button",{onClick:a,className:"p-2 rounded-lg hover-elevate active-elevate-2","aria-label":"Cerrar modal","data-testid":"button-modal-close",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-accent/20 border rounded-lg p-6 flex items-center justify-center gap-4",children:[(0,r.jsx)("button",{onClick:i,className:"p-4 rounded-full bg-primary text-primary-foreground hover-elevate active-elevate-2 border-2 border-primary-border","aria-label":l?"Pausar audio":"Reproducir audio","data-testid":"button-play-pause",children:l?(0,r.jsx)(u.Z,{className:"h-8 w-8"}):(0,r.jsx)(n.Z,{className:"h-8 w-8"})}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:l?"Reproduciendo...":"Haz clic para reproducir"})]}),s.snippet&&(0,r.jsx)("div",{className:"bg-muted/50 rounded-lg p-4 border",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground italic leading-relaxed","data-testid":"text-transcript-snippet",children:s.snippet})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsxs)("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover-elevate active-elevate-2 border-2 border-primary-border","data-testid":"button-show-transcript",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),"\uD83D\uDCDD Ver transcripci\xf3n completa"]}),(0,r.jsxs)("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-accent text-accent-foreground rounded-lg hover-elevate active-elevate-2 border","data-testid":"button-show-quiz",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4"}),"❓ Hacer quiz"]})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"\uD83D\uDCA1 El audio continuar\xe1 reproduci\xe9ndose mientras navegas por la transcripci\xf3n o el quiz"})]})}):null}var g=a(7648),h=a(6858),v=a(4938);let b={a1:{next:"A2",url:"/spanish-audio-for-beginners-a2",label:"Ir al nivel A2"},a2:{next:"B1",url:"/intermediate-spanish-b1",label:"Ir al nivel B1"},b1:{next:"B2",url:"/intermediate-spanish-b2",label:"Ir al nivel B2"},b2:{next:"C1",url:"/advanced-spanish-c1",label:"Ir al nivel C1"},c1:{next:"C2",url:"/advanced-spanish-c2",label:"Ir al nivel C2"},c2:{}};function f(e){let{currentLevel:t}=e,a=b[t];return(0,r.jsxs)("div",{className:"bg-accent/30 border rounded-xl p-6 space-y-4 mt-8","data-testid":"next-level-cta",children:[(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("p",{className:"text-lg font-semibold",children:"\uD83C\uDFAF \xbfListo para el siguiente reto?"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["\uD83D\uDC49 ",a.next?"Explora los audios del nivel ".concat(a.next):"Completa tus audios favoritos"," o repite tus favoritos."]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[a.next&&a.url&&(0,r.jsxs)(g.default,{href:a.url,className:"flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover-elevate active-elevate-2 border-2 border-primary-border font-medium","data-testid":"button-next-level",children:[a.label,(0,r.jsx)(h.Z,{className:"h-4 w-4"})]}),(0,r.jsxs)(g.default,{href:"/spanish-listening",className:"flex items-center gap-2 px-6 py-3 bg-background border rounded-lg hover-elevate active-elevate-2 font-medium","data-testid":"button-back-home",children:[(0,r.jsx)(v.Z,{className:"h-4 w-4"}),"Volver al inicio"]})]})]})}var j=a(1817),y=a(9322),k=a(2451),N=a(407),w=a(2119);function C(e){let{level:t,pageSize:a=12,onAudioSelect:l}=e,[i,o]=(0,s.useState)(null),[m,p]=(0,s.useState)(1),[g,h]=(0,s.useState)(!0),[v,b]=(0,s.useState)(null),[C,D]=(0,s.useState)(null),[S,P]=(0,s.useState)(!1),[A,z]=(0,s.useState)(null),[E,q]=(0,s.useState)(null),[I,T]=(0,s.useState)(!1),[Z,O]=(0,s.useState)({}),B=(0,s.useRef)(null),R=(0,s.useRef)(0);(0,s.useEffect)(()=>{p(1),D(null),P(!1),z(null),B.current&&(B.current.pause(),B.current.currentTime=0),q(null),T(!1);let e=(0,w.xC)(),t={};Object.values(e.audioProgress).forEach(e=>{t[e.audioId]=e.listenPercentage||0}),O(t)},[t]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{h(!0),b(null);try{let r=await fetch("/api/audios?level=".concat(t,"&page=").concat(m,"&pageSize=").concat(a));if(!r.ok)throw Error("Error: ".concat(r.status));let s=await r.json();e&&o(s)}catch(t){e&&(b(t instanceof Error?t.message:"Error al cargar audios"),console.error("Error fetching audios:",t))}finally{e&&h(!1)}})(),()=>{e=!1}},[t,m,a]);let F=e=>{let t=null==i?void 0:i.items.find(t=>t.id===e);t&&((null==E?void 0:E.id)!==t.id&&(B.current&&(B.current.pause(),B.current.currentTime=0,B.current.src=t.file,B.current.load()),q(t),T(!1)),z(t),P(!0))},M=()=>{B.current&&(I?B.current.pause():B.current.play().catch(e=>{console.error("Error playing audio:",e)}))};return g?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4","data-testid":"loading-state",children:[(0,r.jsx)(j.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Cargando audios..."})]}):v?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4","data-testid":"error-state",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,r.jsx)(y.Z,{className:"h-6 w-6"}),(0,r.jsx)("p",{className:"font-medium",children:v})]}),(0,r.jsx)("button",{onClick:()=>{p(m)},className:"px-4 py-2 rounded-md bg-primary text-primary-foreground hover-elevate active-elevate-2 border-2 border-primary-border","data-testid":"button-retry",children:"Reintentar"})]}):i&&0!==i.items.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("audio",{ref:B,preload:"none",onPlay:()=>{T(!0),E&&((0,w._d)(E.id,E.level,0),O(e=>({...e,[E.id]:0})),R.current=0)},onTimeUpdate:()=>{if(E&&B.current){let e=B.current.currentTime,t=B.current.duration;if(t>0){let a=Math.floor(e/t*100);(a>=R.current+5||a>=90)&&((0,w._d)(E.id,E.level,a),R.current=a,O(e=>({...e,[E.id]:a})))}}},onPause:()=>T(!1),onEnded:()=>{T(!1),E&&((0,w._d)(E.id,E.level,100),R.current=100,O(e=>({...e,[E.id]:100})))},className:"hidden"}),E&&!S&&(0,r.jsxs)("div",{className:"fixed bottom-4 right-4 bg-background border-2 rounded-xl shadow-lg p-4 flex items-center gap-3 z-40 max-w-sm","data-testid":"mini-player",children:[(0,r.jsx)("button",{onClick:M,className:"p-2 rounded-full bg-primary text-primary-foreground hover-elevate active-elevate-2 border-2 border-primary-border flex-shrink-0","aria-label":I?"Pausar":"Reproducir","data-testid":"button-mini-play-pause",children:I?(0,r.jsx)(u.Z,{className:"h-5 w-5"}):(0,r.jsx)(n.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium truncate",children:E.title}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:I?"Reproduciendo...":"Pausado"})]}),(0,r.jsx)("button",{onClick:()=>{B.current&&(B.current.pause(),B.current.currentTime=0),q(null),T(!1)},className:"p-2 rounded-lg hover-elevate active-elevate-2 flex-shrink-0","aria-label":"Cerrar reproductor","data-testid":"button-mini-close",children:(0,r.jsx)(c.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-8","data-testid":"paginated-audio-list",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.items.map(e=>(0,r.jsx)(d,{id:e.id,title:e.title,duration:e.duration,snippet:e.snippet,level:e.level,onPlayClick:()=>F(e.id),listenPercentage:Z[e.id]||0},e.id))}),i.totalPages>1&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 pt-8 border-t",children:[(0,r.jsxs)("button",{onClick:()=>{m>1&&(p(m-1),window.scrollTo({top:0,behavior:"smooth"}))},disabled:1===m,className:"flex items-center gap-2 px-4 py-2 rounded-md border hover-elevate active-elevate-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:no-default-hover-elevate","data-testid":"button-previous-page",children:[(0,r.jsx)(k.Z,{className:"h-4 w-4"}),"Anterior"]}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground","data-testid":"text-page-info",children:["P\xe1gina ",m," de ",i.totalPages]}),(0,r.jsxs)("button",{onClick:()=>{i&&m<i.totalPages&&(p(m+1),window.scrollTo({top:0,behavior:"smooth"}))},disabled:m===i.totalPages,className:"flex items-center gap-2 px-4 py-2 rounded-md border hover-elevate active-elevate-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:no-default-hover-elevate","data-testid":"button-next-page",children:["Siguiente",(0,r.jsx)(N.Z,{className:"h-4 w-4"})]})]}),i.total>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"text-center text-sm text-muted-foreground","data-testid":"text-total-audios",children:[i.total," ",1===i.total?"audio":"audios"," en total"]}),(0,r.jsx)(f,{currentLevel:t})]})]}),A&&(0,r.jsx)(x,{isOpen:S,onClose:()=>{P(!1)},audio:{id:A.id,title:A.title,file:A.file,snippet:A.snippet,level:A.level},isPlaying:I,onPlayPause:M,onShowTranscript:()=>{A&&(D(A.id),P(!1),null==l||l(A),setTimeout(()=>{let e=document.getElementById("transcript-section");if(e){let t=e.getBoundingClientRect().top+window.pageYOffset+-100;window.scrollTo({top:t,behavior:"smooth"}),setTimeout(()=>{let e=document.querySelector('[data-testid="button-toggle-transcript"]');e&&"false"===e.getAttribute("aria-expanded")&&e.click()},400)}},300))},onShowQuiz:()=>{A&&(D(A.id),P(!1),null==l||l(A),setTimeout(()=>{let e=document.getElementById("quiz-section");if(e){let t=e.getBoundingClientRect().top+window.pageYOffset+-100;window.scrollTo({top:t,behavior:"smooth"})}},300))}})]}):(0,r.jsx)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4","data-testid":"empty-state",children:(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"No hay audios disponibles en este nivel."})})}var D=a(7586),S=a(1769),P=a(875),A=a(9708);function z(e){let{hasSelectedAudio:t,currentLevelSlug:a}=e,[l,i]=(0,s.useState)(""),[o,n]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=new IntersectionObserver(e=>{let t=e.filter(e=>e.isIntersecting);t.length>0&&i(t.sort((e,t)=>t.intersectionRatio-e.intersectionRatio)[0].target.id)},{threshold:[0,.25,.5,.75,1],rootMargin:"-100px 0px -66% 0px"});return["audio-list","audio-content","transcript-section","vocab-section","quiz-section"].forEach(t=>{let a=document.getElementById(t);a&&e.observe(a)}),()=>e.disconnect()},[t]);let d=e=>{let t=document.getElementById(e);if(t){let e=t.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:e,behavior:"smooth"})}},c=[{id:"audio-list",label:"Lista de Audios",icon:D.Z,alwaysShow:!0},{id:"audio-content",label:"Contenido del Audio",icon:m.Z,alwaysShow:!1},{id:"transcript-section",label:"Transcripci\xf3n",icon:m.Z,alwaysShow:!1},{id:"vocab-section",label:"Vocabulario",icon:S.Z,alwaysShow:!1},{id:"quiz-section",label:"Quiz",icon:p.Z,alwaysShow:!1}],u=A.zq.filter(e=>e.slug!==a);return(0,r.jsxs)("nav",{className:"sticky top-4 space-y-6","data-testid":"table-of-contents",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-muted-foreground mb-4 px-3",children:"\xcdNDICE"}),(0,r.jsx)("div",{className:"space-y-1",children:c.map(e=>{if(!(e.alwaysShow||t))return null;let a=e.icon,s=l===e.id;return(0,r.jsxs)("button",{onClick:()=>d(e.id),className:"\n                  w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors text-left\n                  ".concat(s?"bg-primary/10 text-primary font-medium":"text-muted-foreground hover-elevate active-elevate-2","\n                "),"aria-current":s?"location":void 0,"data-testid":"toc-link-".concat(e.id),children:[(0,r.jsx)(a,{className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("span",{children:e.label})]},e.id)})})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsxs)("button",{onClick:()=>n(!o),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm font-semibold text-muted-foreground hover-elevate active-elevate-2 transition-colors","data-testid":"button-toggle-levels","aria-expanded":o,"aria-controls":"other-levels-menu",children:[(0,r.jsx)("span",{children:"OTROS NIVELES"}),(0,r.jsx)(P.Z,{className:"h-4 w-4 transition-transform duration-200 ".concat(o?"rotate-180":"")})]}),o&&(0,r.jsx)("div",{id:"other-levels-menu",className:"space-y-1 mt-2",children:u.map(e=>(0,r.jsxs)(g.default,{href:e.url,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors text-muted-foreground hover-elevate active-elevate-2","data-testid":"toc-link-level-".concat(e.slug),children:[(0,r.jsx)("div",{className:"h-4 w-4 rounded-sm flex-shrink-0",style:{backgroundColor:e.color}}),(0,r.jsxs)("span",{children:["Nivel ",e.name]})]},e.slug))})]})]})}let E=(0,l.default)(()=>a.e(569).then(a.bind(a,3569)).then(e=>({default:e.Transcript})),{loadableGenerated:{webpack:()=>[3569]},loading:()=>(0,r.jsx)("div",{className:"h-32 bg-card rounded-xl border animate-pulse"})}),q=(0,l.default)(()=>a.e(384).then(a.bind(a,2384)).then(e=>({default:e.VocabList})),{loadableGenerated:{webpack:()=>[2384]},loading:()=>(0,r.jsx)("div",{className:"h-48 bg-card rounded-xl border animate-pulse"})}),I=(0,l.default)(()=>a.e(418).then(a.bind(a,2418)).then(e=>({default:e.Quiz})),{loadableGenerated:{webpack:()=>[2418]},loading:()=>(0,r.jsx)("div",{className:"h-96 bg-card rounded-xl border animate-pulse"}),ssr:!1});function T(e){let{levelSlug:t}=e,[a,l]=(0,s.useState)(null);return(0,s.useEffect)(()=>{l(null)},[t]),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[220px_1fr] gap-8",children:[(0,r.jsx)("aside",{className:"hidden lg:block",children:(0,r.jsx)(z,{hasSelectedAudio:!!a,currentLevelSlug:t})}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{id:"audio-list",children:(0,r.jsx)(C,{level:t,onAudioSelect:l})}),a&&(0,r.jsxs)("div",{className:"space-y-8 mt-12 pt-8 border-t",id:"audio-content",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6","data-testid":"text-selected-audio-title",children:a.title})}),(0,r.jsx)("div",{id:"transcript-section",children:(0,r.jsx)(E,{text:a.transcript})}),(0,r.jsx)("div",{id:"vocab-section",children:(0,r.jsx)(q,{items:a.vocab})}),(0,r.jsx)("div",{id:"quiz-section",children:(0,r.jsx)(I,{questions:a.quiz,levelSlug:"".concat(t,"-").concat(a.id),audioId:a.id,level:a.level})})]})]})]})}},9708:function(e,t,a){a.d(t,{zq:function(){return r}});let r=[{slug:"a1",name:"A1",description:"Principiante - Conversaciones b\xe1sicas del d\xeda a d\xeda",color:"hsl(180 70% 50%)",url:"/spanish-audio-for-beginners-a1"},{slug:"a2",name:"A2",description:"Elemental - Situaciones cotidianas y familiares",color:"hsl(200 70% 50%)",url:"/spanish-audio-for-beginners-a2"},{slug:"b1",name:"B1",description:"Intermedio - Temas conocidos y de inter\xe9s personal",color:"hsl(220 70% 50%)",url:"/intermediate-spanish-b1"},{slug:"b2",name:"B2",description:"Intermedio Alto - Textos complejos y abstractos",color:"hsl(240 70% 50%)",url:"/intermediate-spanish-b2"},{slug:"c1",name:"C1",description:"Avanzado - Textos largos y exigentes",color:"hsl(260 45% 75%)",url:"/advanced-spanish-c1"},{slug:"c2",name:"C2",description:"Maestr\xeda - Comprensi\xf3n total y expresi\xf3n precisa",color:"hsl(280 45% 75%)",url:"/advanced-spanish-c2"}]},2119:function(e,t,a){a.d(t,{AG:function(){return d},Lb:function(){return p},_d:function(){return n},i6:function(){return m},xC:function(){return l}});let r="spanish-listening-progress",s=[{id:"first-audio",name:"Primer Paso",description:"Escucha tu primer audio",icon:"\uD83C\uDFA7",category:"completion"},{id:"streak-7",name:"Una Semana",description:"Practica 7 d\xedas seguidos",icon:"\uD83D\uDD25",category:"streak"},{id:"streak-30",name:"Un Mes",description:"Practica 30 d\xedas seguidos",icon:"⭐",category:"streak"},{id:"streak-100",name:"Centenario",description:"Practica 100 d\xedas seguidos",icon:"\uD83D\uDC51",category:"streak"},{id:"complete-level-a1",name:"Principiante Completo",description:"Completa todos los audios del nivel A1",icon:"\uD83C\uDF31",category:"completion"},{id:"complete-level-a2",name:"Elemental Completo",description:"Completa todos los audios del nivel A2",icon:"\uD83C\uDF3F",category:"completion"},{id:"complete-level-b1",name:"Intermedio Completo",description:"Completa todos los audios del nivel B1",icon:"\uD83C\uDF33",category:"completion"},{id:"complete-level-b2",name:"Intermedio Alto Completo",description:"Completa todos los audios del nivel B2",icon:"\uD83C\uDFD4️",category:"completion"},{id:"complete-level-c1",name:"Avanzado Completo",description:"Completa todos los audios del nivel C1",icon:"\uD83D\uDE80",category:"completion"},{id:"complete-level-c2",name:"Maestr\xeda Completo",description:"Completa todos los audios del nivel C2",icon:"\uD83D\uDC8E",category:"completion"},{id:"perfect-score",name:"Perfeccionista",description:"Obt\xe9n 100% en 5 quizzes",icon:"\uD83D\uDCAF",category:"mastery"},{id:"quiz-master",name:"Maestro del Quiz",description:"Completa 50 quizzes",icon:"\uD83D\uDCDD",category:"mastery"},{id:"audio-lover",name:"Amante del Audio",description:"Escucha 100 audios",icon:"\uD83C\uDFB5",category:"completion"},{id:"speed-learner",name:"Aprendiz R\xe1pido",description:"Completa un nivel en menos de una semana",icon:"⚡",category:"speed"}];function l(){try{let e=localStorage.getItem(r);if(!e)return i();let t=JSON.parse(e);return{...t,createdAt:new Date(t.createdAt),lastUpdatedAt:new Date(t.lastUpdatedAt),badges:t.badges.map(e=>({...e,unlockedAt:e.unlockedAt?new Date(e.unlockedAt):void 0}))}}catch(e){return console.error("Error loading progress:",e),i()}}function i(){return{audioProgress:{},streak:{currentStreak:0,longestStreak:0,lastPracticeDate:"",totalDays:0},badges:s.map(e=>({...e,unlocked:!1})),totalListeningTime:0,createdAt:new Date,lastUpdatedAt:new Date}}function o(e){try{let t={...e,lastUpdatedAt:new Date};localStorage.setItem(r,JSON.stringify(t))}catch(e){console.error("Error saving progress:",e)}}function n(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;{let t=localStorage.getItem(r);if(t)try{var s;let r=JSON.parse(t),l=null===(s=r.audioProgress)||void 0===s?void 0:s[e];if(l&&(l.listenPercentage||0)>=a)return}catch(e){}}let i=l();i.audioProgress[e]||(i.audioProgress[e]={audioId:e,level:t,completed:!1,quizAttempts:0,listenPercentage:0}),i.audioProgress[e].listenedAt=new Date,i.audioProgress[e].listenPercentage=Math.max(i.audioProgress[e].listenPercentage||0,a),c(i),u(i),o(i)}function d(e,t,a){let r=l();r.audioProgress[e]||(r.audioProgress[e]={audioId:e,level:t,completed:!1,quizAttempts:0,listenPercentage:0});let s=r.audioProgress[e];s.quizScore=a,s.quizAttempts+=1,s.completed=!0,c(r),u(r),o(r)}function c(e){let t=new Date().toISOString().split("T")[0],a=e.streak.lastPracticeDate;if(!a){e.streak.currentStreak=1,e.streak.longestStreak=1,e.streak.totalDays=1,e.streak.lastPracticeDate=t;return}if(a===t)return;let r=new Date;r.setDate(r.getDate()-1),a===r.toISOString().split("T")[0]?(e.streak.currentStreak+=1,e.streak.longestStreak=Math.max(e.streak.longestStreak,e.streak.currentStreak)):e.streak.currentStreak=1,e.streak.totalDays+=1,e.streak.lastPracticeDate=t}function u(e){let t=m(e);e.badges.forEach(a=>{var r,s,l,i,o,n;if(a.unlocked)return;let d=!1;switch(a.id){case"first-audio":d=Object.keys(e.audioProgress).length>=1;break;case"streak-7":d=e.streak.currentStreak>=7;break;case"streak-30":d=e.streak.currentStreak>=30;break;case"streak-100":d=e.streak.currentStreak>=100;break;case"complete-level-a1":d=(null===(r=t.find(e=>"a1"===e.level))||void 0===r?void 0:r.completedAudios)===6;break;case"complete-level-a2":d=(null===(s=t.find(e=>"a2"===e.level))||void 0===s?void 0:s.completedAudios)===6;break;case"complete-level-b1":d=(null===(l=t.find(e=>"b1"===e.level))||void 0===l?void 0:l.completedAudios)===6;break;case"complete-level-b2":d=(null===(i=t.find(e=>"b2"===e.level))||void 0===i?void 0:i.completedAudios)===6;break;case"complete-level-c1":d=(null===(o=t.find(e=>"c1"===e.level))||void 0===o?void 0:o.completedAudios)===6;break;case"complete-level-c2":d=(null===(n=t.find(e=>"c2"===e.level))||void 0===n?void 0:n.completedAudios)===6;break;case"perfect-score":d=Object.values(e.audioProgress).filter(e=>100===e.quizScore).length>=5;break;case"quiz-master":d=Object.values(e.audioProgress).filter(e=>e.quizAttempts>0).length>=50;break;case"audio-lover":d=Object.keys(e.audioProgress).length>=100}d&&(a.unlocked=!0,a.unlockedAt=new Date)})}function m(e){return["a1","a2","b1","b2","c1","c2"].map(t=>{let a=Object.values(e.audioProgress).filter(e=>e.level===t),r=a.filter(e=>e.completed).length,s=a.map(e=>e.quizScore).filter(e=>void 0!==e);return{level:t,totalAudios:6,completedAudios:r,averageScore:s.length>0?Math.round(s.reduce((e,t)=>e+t,0)/s.length):0,totalQuizzes:a.filter(e=>e.quizAttempts>0).length}})}function p(e){return Math.round(Object.values(e.audioProgress).filter(e=>e.completed).length/36*100)}}}]);