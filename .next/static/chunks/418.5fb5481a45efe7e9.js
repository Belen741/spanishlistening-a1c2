"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418],{2418:function(e,t,r){r.r(t),r.d(t,{Quiz:function(){return m}});var a=r(7437),s=r(2265),n=r(2135),c=r(875),i=r(2934),l=r(9205);let d=(0,l.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),o=(0,l.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var u=r(2119);function m(e){let{questions:t,levelSlug:r,audioId:l,level:m}=e,[p,x]=(0,s.useState)(!1),[h,b]=(0,s.useState)([]),[y,f]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("quiz:".concat(r));if(e)try{v(JSON.parse(e))}catch(e){console.error("Failed to parse stored quiz result:",e)}b(t.map(e=>"multiple"===e.type?[]:-1))},[r,t]);let N=(e,t)=>{if(y)return;let r=[...h];r[e]=t,b(r)},j=(e,t)=>{if(y)return;let r=h[e]||[],a=[...h];r.includes(t)?a[e]=r.filter(e=>e!==t):a[e]=[...r,t],b(a)},w=(e,t)=>{if("single"===e.type)return t===e.answerIndex;{let r=Array.isArray(e.answerIndex)?e.answerIndex:[e.answerIndex],a=Array.isArray(t)?t:[];return r.length===a.length&&r.every(e=>a.includes(e))}},k=h.every(e=>Array.isArray(e)?e.length>0:-1!==e);return(0,a.jsxs)("div",{className:"bg-card rounded-xl border","data-testid":"quiz-container",children:[(0,a.jsxs)("button",{onClick:()=>x(!p),className:"w-full flex items-center justify-between p-5 bg-primary/5 hover-elevate active-elevate-2 rounded-t-xl border-l-4 border-l-primary","aria-expanded":p,"data-testid":"button-toggle-quiz",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:"Quiz de Comprensi\xf3n"}),!p&&g&&(0,a.jsxs)("span",{className:"text-sm text-muted-foreground font-normal","data-testid":"text-last-score",children:["(",g.score,"/",g.total,")"]})]}),p?(0,a.jsx)(n.Z,{className:"h-6 w-6 text-primary"}):(0,a.jsx)(c.Z,{className:"h-6 w-6 text-primary"})]}),p&&(0,a.jsxs)("div",{className:"border-t p-6 space-y-6",children:[g&&!y&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground text-center pb-2 border-b","data-testid":"text-last-result",children:["\xdaltimo resultado: ",g.score,"/",g.total]}),(0,a.jsx)("div",{className:"space-y-6",children:t.map((e,t)=>{let r=h[t],s=y&&w(e,r);return y&&w(e,r),(0,a.jsxs)("div",{className:"space-y-3 pb-6 border-b last:border-b-0 last:pb-0","data-testid":"question-".concat(t),children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsxs)("span",{className:"font-medium text-muted-foreground min-w-[2rem]",children:[t+1,"."]}),(0,a.jsx)("p",{className:"font-medium text-base flex-1","data-testid":"question-text-".concat(t),children:e.question}),y&&(s?(0,a.jsx)(i.Z,{className:"h-5 w-5 text-success flex-shrink-0","data-testid":"icon-correct-".concat(t)}):(0,a.jsx)(d,{className:"h-5 w-5 text-destructive flex-shrink-0","data-testid":"icon-incorrect-".concat(t)}))]}),(0,a.jsx)("div",{className:"pl-8 space-y-2",children:e.options.map((s,n)=>{let c=Array.isArray(r)?r.includes(n):r===n,i=Array.isArray(e.answerIndex)?e.answerIndex.includes(n):e.answerIndex===n,l=y&&i,d=y&&c&&!i;return(0,a.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border-2 transition-all cursor-pointer ".concat(l?"border-success bg-success/10":d?"border-destructive bg-destructive/10":c?"border-primary bg-primary/5":"border-border hover-elevate"," ").concat(y?"cursor-default":""),"data-testid":"option-".concat(t,"-").concat(n),children:[(0,a.jsx)("input",{type:"single"===e.type?"radio":"checkbox",name:"question-".concat(t),checked:c,onChange:()=>{"single"===e.type?N(t,n):j(t,n)},disabled:y,className:"mt-0.5 accent-primary","data-testid":"input-option-".concat(t,"-").concat(n)}),(0,a.jsx)("span",{className:"flex-1",children:s})]},n)})}),y&&(0,a.jsxs)("div",{className:"pl-8 mt-3 p-3 rounded-lg bg-muted/50 border-l-4 border-primary",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-1",children:"Explicaci\xf3n:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground","data-testid":"explanation-".concat(t),children:e.explanation})]})]},e.id)})}),y?(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"text-center p-6 bg-primary/10 rounded-lg","data-testid":"quiz-results",children:[(0,a.jsx)("div",{className:"text-4xl font-bold mb-2",children:g&&"".concat(g.score,"/").concat(g.total)}),(0,a.jsx)("p",{className:"text-muted-foreground",children:g&&g.score===g.total?"\xa1Perfecto! Has respondido todas correctamente.":g&&g.score>=.7*g.total?"\xa1Muy bien! Buen trabajo.":"\xa1Sigue practicando!"})]}),(0,a.jsxs)("button",{onClick:()=>{b(t.map(e=>"multiple"===e.type?[]:-1)),f(!1),window.scrollTo({top:0,behavior:"smooth"})},className:"w-full py-3 rounded-lg border-2 border-primary text-primary font-medium hover-elevate active-elevate-2 flex items-center justify-center gap-2","data-testid":"button-retry-quiz",children:[(0,a.jsx)(o,{className:"h-5 w-5"}),"Reintentar Quiz"]})]}):(0,a.jsx)("button",{onClick:()=>{let e=t.reduce((e,t,r)=>e+(w(t,h[r])?1:0),0),a={score:e,total:t.length,answers:h,timestamp:Date.now()};if(localStorage.setItem("quiz:".concat(r),JSON.stringify(a)),v(a),f(!0),l&&m){let r=Math.round(e/t.length*100);(0,u.AG)(l,m,r)}window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},disabled:!k,className:"w-full py-3 rounded-lg bg-primary text-primary-foreground font-medium hover-elevate active-elevate-2 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-primary-border","data-testid":"button-submit-quiz",children:k?"Enviar Respuestas":"Responde todas las preguntas para continuar"})]})]})}},2135:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},2934:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])}}]);